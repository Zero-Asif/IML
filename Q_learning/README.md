# Temperature Prediction Using Q-Learning

This repository contains a Python implementation of a simple Q-Learning algorithm to predict temperature values based on simulated data. The model learns by iteratively updating its Q-table to minimize the prediction error.

## Overview

Q-Learning is a reinforcement learning algorithm that uses a Q-table to store the expected utility of actions in various states. In this project, Q-Learning is applied to predict temperature values from a sinusoidal dataset. The model predicts the next temperature value based on the current state, aiming to minimize the absolute difference between the actual and predicted values.

## Code Breakdown

### 1. Import Libraries
```python
import numpy as np
import random
import matplotlib.pyplot as plt
```

### 2. Generate Simulated Temperature Data
A sinusoidal dataset is used to simulate temperature variations:
```python
temperature_data = np.sin(np.linspace(0, 10, 100)) * 10 + 20
```

### 3. Define States and Actions
- **States**: Represent indices in the temperature dataset (excluding the last value).
- **Actions**: Represent possible predicted temperature values ranging from 15 to 35 (in steps of 0.5).
```python
states = range(len(temperature_data) - 1)  
actions = np.arange(15, 35, 0.5)  
```

### 4. Initialize Q-Table
The Q-table is initialized with zeros:
```python
q_table = np.zeros((len(states), len(actions)))
```

### 5. Define Parameters
- **Learning Rate** (`learning_rate`): Controls how much the Q-table is updated per step.
- **Discount Factor** (`discount_factor`): Weighs the importance of future rewards.
- **Epsilon** (`epsilon`): Governs exploration vs. exploitation during training.
```python
learning_rate = 0.1
discount_factor = 0.95
epsilon = 0.1
```

### 6. Reward Function
The reward is calculated based on the negative absolute difference between true and predicted temperatures:
```python
def calculate_reward(true_temp, predicted_temp):
    return -abs(true_temp - predicted_temp)
```

### 7. Q-Learning Process
The algorithm is trained for 1000 episodes, updating the Q-table based on actions and rewards:
```python
for episode in range(1000):
    state = random.choice(states)
    for _ in range(50):
        if random.uniform(0, 1) < epsilon:
            action = random.choice(range(len(actions)))  
        else:
            action = np.argmax(q_table[state])

        next_state = (state + 1) % len(states)
        true_temp = temperature_data[next_state]
        predicted_temp = actions[action]
        reward = calculate_reward(true_temp, predicted_temp)

        q_table[state, action] += learning_rate * (
            reward + discount_factor * np.max(q_table[next_state]) - q_table[state, action]
        )

        state = next_state
```

### 8. Generate Predictions
Using the trained Q-table, predictions are generated for all states:
```python
state = 0
predictions = []
for _ in range(len(states)):
    action = np.argmax(q_table[state])
    predictions.append(actions[action])
    state = (state + 1) % len(states)
```

### 9. Visualization
The predicted temperature values are compared with the actual temperature data:
```python
plt.plot(temperature_data, label="Actual Temperature")
plt.plot(predictions, label="Predicted Temperature", linestyle="--")
plt.legend()
plt.show()
```

## Results
The plot generated by the script displays:
- **Actual Temperature**: The sinusoidal temperature data used for training.
- **Predicted Temperature**: The temperature values predicted by the Q-Learning model.

## How to Use

1. Clone the repository:
   ```bash
   git clone https://github.com/Zero-Asif/IML.git
   cd IML/Q_learning
   ```
2. Run the script:
   ```bash
   python temperature_prediction.py
   ```
3. View the output plot to analyze the model's performance.

## Requirements
- Python 3.x
- NumPy
- Matplotlib

Install dependencies using pip:
```bash
pip install numpy matplotlib
```

---

## Contributing
Contributions are welcome! Please fork the repository and create a pull request for any improvements or bug fixes.

---

## Author

- **Asifuzzaman**  
- GitHub: [Zero-Asif](https://github.com/Zero-Asif)

---
